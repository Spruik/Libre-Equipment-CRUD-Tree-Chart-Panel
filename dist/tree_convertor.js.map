{"version":3,"sources":["../src/tree_convertor.js"],"names":["getTreeStructureData","data","obj","children","name","type","parent","distinctSites","findDisctinct","console","log","i","length","site","ob","info","push","getAreas","areas","filter","d","area","distinctAreas","k","collapsed","getLines","lines","production_line","distinctLines","l","line","getEquiment","e","equipment","disctinctEquipment","equip","arrObj","s","areaArr","reduce","arr","record","Array","from","Set"],"mappings":"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","file":"tree_convertor.js","sourcesContent":["  /**\n   * Expecting list of all data\n   * Then first make a root, and sites\n   * @param {*} data \n   */\n  export function getTreeStructureData(data){\n    //root\n    let obj = {\n      children: [],\n      name: 'Bernatellos',\n      type: 'Root',\n      parent: null\n    }\n\n    //take all sites out from an array of objects, find disctinct, and make those distinct values a new array of strings\n    const distinctSites = findDisctinct(data, 'site')\n    console.log(data);\n    for (let i = 0; i < distinctSites.length; i++) {\n      const site = distinctSites[i];\n      let ob = {\n        name: site,\n        children: [], \n        // collapsed: false,\n        type: 'Site', \n        parent: obj.name,\n        info:{\n            site: site\n        }\n      }\n      obj.children.push(ob)\n    }\n\n    return getAreas(obj, data)\n  }\n\n  /**\n   * Expecting the tree structed obj, and the list structured array of objects\n   * Add distinct areas to their matching sites\n   * @param {*} obj \n   * @param {*} data \n   */\n  function getAreas(obj, data){\n    //Under the mother root, for each sites\n    for (let i = 0; i < obj.children.length; i++) {\n      const site = obj.children[i];\n      //find areas that are under this site\n      const areas = data.filter(d => d.area !== null && d.site === site.name)\n      //all areas to distinct areas\n      const distinctAreas = findDisctinct(areas, 'area')\n      //add each distinct area to this site\n      for (let k = 0; k < distinctAreas.length; k++) {\n        const area = distinctAreas[k];\n        let ob = {\n          name: area, \n          children: [], \n          collapsed: false,\n          type: 'Area', \n          parent: obj.children[i].name,\n          info: {\n            site: site.name,\n            area: area\n          }\n        }\n        obj.children[i].children.push(ob)\n      }\n    }\n    return getLines(obj, data)\n  }\n\n  /**\n   * Expecting the tree structed obj, and the list structured array of objects\n   * Add distinct lines to their matching areas\n   * @param {*} obj \n   * @param {*} data \n   */\n  function getLines(obj, data){\n    for (let i = 0; i < obj.children.length; i++) {\n      const site = obj.children[i];\n      for (let k = 0; k < site.children.length; k++) {\n        const area = obj.children[i].children[k];\n        const lines = data.filter(d => d.production_line !== null && d.area === area.name && d.site === area.parent)\n        const distinctLines = findDisctinct(lines, 'line')\n        for (let l = 0; l < distinctLines.length; l++) {\n          const line = distinctLines[l];\n          let ob = {\n            name: line,\n            children: [], \n            collapsed: false,\n            type: 'Line', \n            parent: obj.children[i].children[k].name,\n            info: {\n              site: site.name,\n              area: area.name,\n              line: line\n            }\n          }\n          obj.children[i].children[k].children.push(ob)\n        }\n      }\n    }\n    return getEquiment(obj, data)\n  }\n\n    /**\n   * Expecting the tree structed obj, and the list structured array of objects\n   * Add distinct lines to their matching areas\n   * @param {*} obj \n   * @param {*} data \n   */\n  function getEquiment(obj, data){\n    for (let i = 0; i < obj.children.length; i++) {\n      const site = obj.children[i];\n      for (let k = 0; k < site.children.length; k++) {\n        const area = site.children[k];\n        for (let e = 0; e < area.children.length; e++) {\n          const line = area.children[e];\n          const equipment = data.filter(d => d.equipment !== null && d.production_line === line.name && d.area === area.name && d.site === area.parent)\n          const disctinctEquipment = findDisctinct(equipment, 'equipment')\n          for (let l = 0; l < disctinctEquipment.length; l++) {\n            const equip = disctinctEquipment[l];\n            let ob = {\n              name: equip,\n              children: [], \n              collapsed: false,\n              type: 'Equipment', \n              parent: line.name,\n              info: {\n                site: site.name,\n                area: area.name,\n                line: line.name,\n                equipment: equip\n              }\n            }\n            obj.children[i].children[k].children[e].children.push(ob)\n          }\n        }\n      }\n    }\n    return obj\n  }\n\n    /**\n   * Expecting an array of objects, and a string of keyword\n   * Based on different attributes keywords passed in\n   * Return an array of distinct and keyword-matching values of the array of objects\n   * @param {*} arrObj \n   * @param {*} s \n   */\n  function findDisctinct(arrObj, s){\n    const areaArr = arrObj.reduce((arr, record) => {\n      if (s === 'site') {\n        arr.push(record.site)\n      }else if (s === 'area'){\n        arr.push(record.area)\n      }else if (s === 'line') {\n        arr.push(record.production_line)\n      }else if (s === 'equipment') {\n        arr.push(record.equipment)\n      }\n      return arr\n    }, [])\n    return Array.from(new Set(areaArr))\n  }"]}